<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOODGAME 2.0</title>
    <style>
        :root {
            /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–º–µ–Ω—ã —Ç–µ–º */
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-color: #333333;
            --secondary-text: #666;
            --header-bg: #ffffff;
            --border-color: #ddd;
            --accent-color: #2196f3;
            --btn-text: #fff;
            --orange-btn: #ff9800;
        }

        /* –¢–ï–ú–ù–ê–Ø –¢–ï–ú–ê (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∫–ª–∞—Å—Å–æ–º .dark-mode) */
        body.dark-mode {
            --bg-color: #1b2838;
            --card-bg: #171a21;
            --text-color: #c7d5e0;
            --secondary-text: #8f98a0;
            --header-bg: #171a21;
            --border-color: #2a475e;
            --accent-color: #66c0f4;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            transition: background 0.3s, color 0.3s;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        header {
            background-color: var(--header-bg);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 24px;
            font-weight: 900;
            color: var(--accent-color);
            cursor: pointer;
        }

        .nav-menu button {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 16px;
            margin-left: 20px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .nav-menu button:hover { background-color: rgba(0,0,0,0.05); }
        .nav-menu button.active { color: var(--accent-color); font-weight: bold; }
        
        /* –ó–Ω–∞—á–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .badge {
            background-color: red;
            color: white;
            padding: 2px 6px;
            border-radius: 50%;
            font-size: 10px;
            vertical-align: top;
            display: none;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        
        .section { display: none; }
        .section.active { display: block; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∏–≥—Ä */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .card img { width: 100%; height: 160px; object-fit: cover; background: #ccc; }
        .card-body { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-title { font-size: 18px; font-weight: bold; margin: 0 0 10px 0; }
        .card-desc { font-size: 13px; color: var(--secondary-text); margin-bottom: 15px; flex-grow: 1; }
        
        /* –¢–µ–≥–∏ –∏ –∫–Ω–æ–ø–∫–∏ */
        .tag { display: inline-block; padding: 2px 8px; font-size: 11px; border-radius: 4px; margin-bottom: 10px; }
        .tag.beta { background: #ff9800; color: #fff; }
        .tag.release { background: #4caf50; color: #fff; }

        .btn {
            border: none; padding: 10px; border-radius: 4px; cursor: pointer; width: 100%; font-weight: bold; text-align: center; text-decoration: none;
            margin-top: 5px;
        }
        .btn-primary { background-color: var(--accent-color); color: var(--btn-text); }
        .btn-orange { background-color: var(--orange-btn); color: var(--btn-text); }
        .btn-outline { border: 1px solid var(--border-color); background: transparent; color: var(--text-color); }
        
        /* –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã */
        .dev-panel { background: var(--card-bg); padding: 20px; border-radius: 8px; border: 1px solid var(--border-color); }
        input, textarea, select {
            width: 100%; padding: 10px; margin: 5px 0 15px; border: 1px solid var(--border-color);
            background: var(--bg-color); color: var(--text-color); box-sizing: border-box; border-radius: 4px;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .msg-item { background: var(--card-bg); padding: 15px; margin-bottom: 10px; border-radius: 8px; border-left: 4px solid var(--accent-color); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        
        /* –í—Ö–æ–¥ */
        #authOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); z-index: 1000;
            display: flex; justify-content: center; align-items: center;
        }
        .auth-box { background: var(--card-bg); padding: 40px; width: 320px; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; }

    </style>
</head>
<body>

<div id="authOverlay">
    <div class="auth-box">
        <h1 class="logo">GOODGAME 2.0</h1>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</p>
        <input type="text" id="loginUser" placeholder="–ù–∏–∫–Ω–µ–π–º">
        <input type="password" id="loginPass" placeholder="–ü–∞—Ä–æ–ª—å">
        <button class="btn btn-primary" onclick="handleLogin()">–í–æ–π—Ç–∏ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
    </div>
</div>

<header id="mainHeader" style="display:none;">
    <div class="logo" onclick="switchTab('store')">GOODGAME</div>
    <div class="nav-menu">
        <button onclick="switchTab('store')" id="btn-store">–ú–∞–≥–∞–∑–∏–Ω</button>
        <button onclick="switchTab('library')" id="btn-library">–ú–æ—è –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</button>
        <button onclick="switchTab('messages')" id="btn-messages">
            –°–æ–æ–±—â–µ–Ω–∏—è <span id="msgBadge" class="badge">0</span>
        </button>
        <button onclick="switchTab('create')" id="btn-create" style="display:none; color: #ff9800;">üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞</button>
        <button onclick="switchTab('settings')" id="btn-settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        <button onclick="logout()">–í—ã–π—Ç–∏ (<span id="userDisplay"></span>)</button>
    </div>
</header>

<div class="container">
    
    <div id="store" class="section active">
        <h2>–ú–∞–≥–∞–∑–∏–Ω –∏–≥—Ä</h2>
        <div class="grid" id="storeGrid">
            </div>
        <div id="emptyStoreMsg" style="text-align:center; padding: 40px; color: grey;">
            –ú–∞–≥–∞–∑–∏–Ω –ø–æ–∫–∞ –ø—É—Å—Ç. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –µ—â–µ –Ω–µ –≤—ã–ø—É—Å—Ç–∏–ª–∏ –∏–≥—Ä—ã.
        </div>
    </div>

    <div id="library" class="section">
        <h2>–ú–æ–∏ –∏–≥—Ä—ã</h2>
        <p>–ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–∞—à–∏ –∫—É–ø–ª–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã –∏ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –±–µ—Ç—ã.</p>
        <div class="grid" id="libraryGrid"></div>
    </div>

    <div id="messages" class="section">
        <h2>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –ö–ª—é—á–∏</h2>
        <div id="messagesList"></div>
    </div>

    <div id="create" class="section">
        <h2>–ü–∞–Ω–µ–ª—å –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</h2>
        <div class="dev-panel">
            <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</h3>
            <input type="text" id="devTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã">
            <input type="text" id="devImg" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É">
            <input type="text" id="devLink" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª –∏–≥—Ä—ã (–∏–ª–∏ —Å–∞–π—Ç)">
            <textarea id="devDesc" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã..."></textarea>
            
            <label>–¢–∏–ø —Ä–µ–ª–∏–∑–∞:</label>
            <select id="devType">
                <option value="release">–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–µ–ª–∏–∑ (–î–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º)</option>
                <option value="beta">–ó–∞–∫—Ä—ã—Ç—ã–π –ë–µ—Ç–∞-—Ç–µ—Å—Ç (–ü–æ –∑–∞—è–≤–∫–∞–º)</option>
            </select>
            
            <button class="btn btn-orange" onclick="publishGame()">–û–ü–£–ë–õ–ò–ö–û–í–ê–¢–¨ –ü–†–û–ï–ö–¢</button>
        </div>

        <h3>–ó–∞—è–≤–∫–∏ –Ω–∞ –±–µ—Ç–∞-—Ç–µ—Å—Ç (–í—Ö–æ–¥—è—â–∏–µ)</h3>
        <div id="betaRequestsList">
            </div>
    </div>

    <div id="settings" class="section">
        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="dev-panel">
            <label style="display:flex; align-items:center; cursor:pointer;">
                <input type="checkbox" id="themeToggle" style="width:auto; margin-right:10px;" onchange="toggleTheme()">
                –í–∫–ª—é—á–∏—Ç—å –¢—ë–º–Ω—É—é —Ç–µ–º—É (Night Mode)
            </label>
        </div>
    </div>

</div>

<script>
    // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• (LOCALSTORAGE) ---
    // –í —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ —ç—Ç–æ –±—ã–ª–æ –±—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (MySQL/MongoDB)
    
    let db = {
        users: [], // {name, pass, library:[], messages:[]}
        games: [], // {id, title, img, desc, link, type, requests:[]}
        currentUser: null
    };

    // –ê–¥–º–∏–Ω—Å–∫–∏–π –ø–∞—Ä–æ–ª—å
    const ADMIN_PASS = "FHSWJDJWJDH@*&$*!@*(#@*dndnanmnasnd";

    // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
    function init() {
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        const storedUsers = localStorage.getItem('gg2_users');
        const storedGames = localStorage.getItem('gg2_games');
        const activeUser = localStorage.getItem('gg2_current');

        if (storedUsers) db.users = JSON.parse(storedUsers);
        if (storedGames) db.games = JSON.parse(storedGames);
        
        // –ê–≤—Ç–æ-–≤—Ö–æ–¥
        if (activeUser) {
            db.currentUser = db.users.find(u => u.name === activeUser);
            if (db.currentUser) {
                showApp();
            }
        }
    }

    // --- –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ---
    function handleLogin() {
        const name = document.getElementById('loginUser').value.trim();
        const pass = document.getElementById('loginPass').value.trim();

        if (!name) return alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è!");

        let user = db.users.find(u => u.name === name);

        if (!user) {
            // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            user = { name: name, pass: pass, library: [], messages: [] };
            db.users.push(user);
            saveData();
            alert("–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –í—Ö–æ–¥–∏–º...");
        } else {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
            if (user.pass !== pass) return alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
        }

        db.currentUser = user;
        localStorage.setItem('gg2_current', name);
        showApp();
    }

    function logout() {
        db.currentUser = null;
        localStorage.removeItem('gg2_current');
        location.reload();
    }

    function showApp() {
        document.getElementById('authOverlay').style.display = 'none';
        document.getElementById('mainHeader').style.display = 'flex';
        document.getElementById('userDisplay').innerText = db.currentUser.name;

        // –ï—Å–ª–∏ –∞–¥–º–∏–Ω - –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
        if (db.currentUser.pass === ADMIN_PASS) {
            document.getElementById('btn-create').style.display = 'block';
            renderBetaRequests(); // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞—è–≤–∫–∏
        }

        updateUI();
    }

    // --- –õ–û–ì–ò–ö–ê –ò–ù–¢–ï–†–§–ï–ô–°–ê ---
    function switchTab(tabId) {
        document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.nav-menu button').forEach(b => b.classList.remove('active'));
        const btn = document.getElementById('btn-' + tabId);
        if(btn) btn.classList.add('active');

        if(tabId === 'store') renderStore();
        if(tabId === 'library') renderLibrary();
        if(tabId === 'messages') renderMessages();
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-mode');
    }

    // --- –õ–û–ì–ò–ö–ê –î–ê–ù–ù–´–• ---
    function saveData() {
        localStorage.setItem('gg2_users', JSON.stringify(db.users));
        localStorage.setItem('gg2_games', JSON.stringify(db.games));
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ —é–∑–µ—Ä–∞ –≤ –ø–∞–º—è—Ç–∏, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è–ª–∏—Å—å –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        if(db.currentUser) {
            // –ù–∞—Ö–æ–¥–∏–º –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é —é–∑–µ—Ä–∞ –≤ –º–∞—Å—Å–∏–≤–µ
            const freshUser = db.users.find(u => u.name === db.currentUser.name);
            db.currentUser = freshUser; 
        }
    }

    // --- –†–ê–ó–†–ê–ë–û–¢–ö–ê (–ê–î–ú–ò–ù) ---
    function publishGame() {
        const title = document.getElementById('devTitle').value;
        const type = document.getElementById('devType').value;
        const link = document.getElementById('devLink').value;
        
        if(!title || !link) return alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è!");

        const newGame = {
            id: Date.now(),
            title: title,
            img: document.getElementById('devImg').value || "https://via.placeholder.com/300x160?text=No+Image",
            desc: document.getElementById('devDesc').value,
            link: link,
            type: type, // 'release' or 'beta'
            requests: [] // –ö—Ç–æ –ø–æ–¥–∞–ª –∑–∞—è–≤–∫—É –Ω–∞ –±–µ—Ç—É
        };

        db.games.unshift(newGame);
        saveData();
        alert("–ü—Ä–æ–µ–∫—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!");
        
        // –û—á–∏—Å—Ç–∫–∞
        document.getElementById('devTitle').value = "";
    }

    // --- –ú–ê–ì–ê–ó–ò–ù –ò –ë–ò–ë–õ–ò–û–¢–ï–ö–ê ---
    function renderStore() {
        const container = document.getElementById('storeGrid');
        container.innerHTML = "";
        
        if(db.games.length > 0) document.getElementById('emptyStoreMsg').style.display = 'none';

        db.games.forEach(game => {
            const hasGame = db.currentUser.library.includes(game.id);
            let actionBtn = "";

            if (hasGame) {
                actionBtn = `<button class="btn btn-outline" disabled>–í –ë–ò–ë–õ–ò–û–¢–ï–ö–ï</button>`;
            } else if (game.type === 'release') {
                actionBtn = `<button class="btn btn-primary" onclick="addToLibrary(${game.id})">–î–û–ë–ê–í–ò–¢–¨ –ë–ï–°–ü–õ–ê–¢–ù–û</button>`;
            } else {
                // –≠—Ç–æ –ë–ï–¢–ê
                const alreadyRequested = game.requests && game.requests.includes(db.currentUser.name);
                if (alreadyRequested) {
                     actionBtn = `<button class="btn btn-outline" disabled>–ó–ê–Ø–í–ö–ê –û–¢–ü–†–ê–í–õ–ï–ù–ê</button>`;
                } else {
                     actionBtn = `<button class="btn btn-orange" onclick="requestBeta(${game.id})">–ü–û–î–ê–¢–¨ –ó–ê–Ø–í–ö–£ –ù–ê –ë–ï–¢–£</button>`;
                }
            }

            const badge = game.type === 'beta' ? '<span class="tag beta">BETA TEST</span>' : '<span class="tag release">RELEASE</span>';

            container.innerHTML += `
                <div class="card">
                    <img src="${game.img}">
                    <div class="card-body">
                        ${badge}
                        <div class="card-title">${game.title}</div>
                        <div class="card-desc">${game.desc}</div>
                        ${actionBtn}
                        <button class="btn btn-outline" style="font-size:12px; margin-top:5px;" onclick="addReview(${game.id})">–ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç–∑—ã–≤</button>
                    </div>
                </div>
            `;
        });
    }

    function renderLibrary() {
        const container = document.getElementById('libraryGrid');
        container.innerHTML = "";
        
        const myGames = db.games.filter(g => db.currentUser.library.includes(g.id));
        
        if(myGames.length === 0) container.innerHTML = "<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∏–≥—Ä.</p>";

        myGames.forEach(game => {
            container.innerHTML += `
                <div class="card">
                    <img src="${game.img}">
                    <div class="card-body">
                        <div class="card-title">${game.title}</div>
                        <a href="${game.link}" target="_blank" class="btn btn-primary">–ó–ê–ü–£–°–¢–ò–¢–¨</a>
                    </div>
                </div>
            `;
        });
    }

    // --- –õ–û–ì–ò–ö–ê –ë–ï–¢–ê –¢–ï–°–¢–û–í ---
    function addToLibrary(gameId) {
        // –ò—â–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —é–∑–µ—Ä–∞ –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –ï–ì–û –¥–∞–Ω–Ω—ã–µ
        const userIndex = db.users.findIndex(u => u.name === db.currentUser.name);
        db.users[userIndex].library.push(gameId);
        saveData();
        renderStore();
    }

    function requestBeta(gameId) {
        const game = db.games.find(g => g.id === gameId);
        if(!game.requests) game.requests = [];
        
        game.requests.push(db.currentUser.name);
        saveData();
        renderStore();
        alert("–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É!");
    }

    function renderBetaRequests() {
        const container = document.getElementById('betaRequestsList');
        container.innerHTML = "";
        
        let found = false;
        db.games.forEach(game => {
            if(game.type === 'beta' && game.requests && game.requests.length > 0) {
                found = true;
                game.requests.forEach(userName => {
                    container.innerHTML += `
                        <div class="msg-item" style="display:flex; justify-content:space-between; align-items:center;">
                            <span>–ò–≥—Ä–æ–∫ <b>${userName}</b> —Ö–æ—á–µ—Ç –¥–æ—Å—Ç—É–ø –∫ <b>${game.title}</b></span>
                            <button class="btn btn-primary" style="width:auto;" onclick="approveBeta(${game.id}, '${userName}')">–ü–†–ò–ù–Ø–¢–¨</button>
                        </div>
                    `;
                });
            }
        });

        if(!found) container.innerHTML = "<p>–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫.</p>";
    }

    function approveBeta(gameId, userName) {
        // 1. –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä—É —é–∑–µ—Ä—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É
        const user = db.users.find(u => u.name === userName);
        if(user) {
            if(!user.library.includes(gameId)) user.library.push(gameId);
            
            // 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
            const game = db.games.find(g => g.id === gameId);
            const secretCode = "KEY-" + Math.floor(Math.random() * 1000000);
            
            user.messages.push({
                title: "–î–æ—Å—Ç—É–ø –∫ –±–µ—Ç–µ: " + game.title,
                text: `–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞. <br> –í–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∞: <b>${secretCode}</b> <br> –°—Å—ã–ª–∫–∞: ${game.link}`,
                date: new Date().toLocaleString()
            });

            // 3. –£–¥–∞–ª—è–µ–º –∏–∑ –∑–∞—è–≤–æ–∫
            game.requests = game.requests.filter(r => r !== userName);
            
            saveData();
            renderBetaRequests();
            alert(`–î–æ—Å—Ç—É–ø –≤—ã–¥–∞–Ω –∏–≥—Ä–æ–∫—É ${userName}! –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ.`);
        }
    }

    // --- –°–û–û–ë–©–ï–ù–ò–Ø ---
    function renderMessages() {
        const container = document.getElementById('messagesList');
        container.innerHTML = "";
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ —é–∑–µ—Ä–∞
        const user = db.users.find(u => u.name === db.currentUser.name);
        
        if(!user.messages || user.messages.length === 0) {
            container.innerHTML = "<p>–í—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç.</p>";
            return;
        }

        user.messages.forEach(msg => {
            container.innerHTML += `
                <div class="msg-item">
                    <h4>${msg.title} <span style="font-size:10px; color:grey; float:right">${msg.date}</span></h4>
                    <p>${msg.text}</p>
                </div>
            `;
        });
        
        // –°–±—Ä–æ—Å –±–µ–π–¥–∂–∏–∫–∞
        document.getElementById('msgBadge').style.display = 'none';
    }

    function updateUI() {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –±–µ–π–¥–∂–∏–∫–∞
        const user = db.users.find(u => u.name === db.currentUser.name);
        if(user && user.messages && user.messages.length > 0) {
            const badge = document.getElementById('msgBadge');
            badge.innerText = user.messages.length;
            badge.style.display = 'inline-block';
        }
    }

    function addReview(gameId) {
        const text = prompt("–í–∞—à –æ—Ç–∑—ã–≤ –æ–± –∏–≥—Ä–µ:");
        if(text) alert("–û—Ç–∑—ã–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! (–ü–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏)");
    }

    // –ó–∞–ø—É—Å–∫
    init();

</script>

</body>
</html>
